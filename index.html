<!DOCTYPE html>
<html>
<head>
    <title>Interactive Contribution Graph</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            color: #24292e;
            padding: 20px;
            background-color: #fff;
        }

        .container {
            padding: 16px;
            max-width: 900px;
        }

        .month-labels {
            display: flex;
            margin-left: 46px;
            margin-bottom: 4px;
        }

        .month-label {
            width: 28px;
            margin-right: 40px;
            font-size: 12px;
            color: #586069;
            text-align: left;
        }

        .graph {
            display: flex;
        }

        .weekday-labels {
            display: flex;
            flex-direction: column;
            text-align: right;
            margin-right: 4px;
        }

        .weekday-label {
            height: 15px;
            font-size: 12px;
            color: #586069;
            margin-bottom: 12px;
            padding-right: 4px;
        }

        .contribution-grid {
            display: grid;
            grid-template-columns: repeat(53, 12px);
            gap: 2px;
            padding: 0;
        }

        .contribution-cell {
            width: 10px;
            height: 10px;
            background-color: #ebedf0;
            border-radius: 2px;
            cursor: pointer;
            position: relative;
        }

        .contribution-cell:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            padding: 8px;
            background: rgba(0,0,0,0.8);
            color: white;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            z-index: 1000;
            margin-bottom: 5px;
        }

        .level-0 { background-color: #ebedf0; }
        .level-1 { background-color: #9be9a8; }
        .level-2 { background-color: #40c463; }
        .level-3 { background-color: #30a14e; }
        .level-4 { background-color: #216e39; }

        .legend {
            display: flex;
            align-items: center;
            margin-top: 16px;
            font-size: 12px;
            color: #586069;
        }

        .legend-text {
            margin-right: 8px;
        }

        .legend-cells {
            display: flex;
            gap: 2px;
            margin-left: 8px;
        }

        .legend-cell {
            width: 10px;
            height: 10px;
            border-radius: 2px;
        }

        .stats {
            margin-top: 20px;
            padding: 16px;
            background-color: #f6f8fa;
            border-radius: 6px;
            font-size: 14px;
        }

        .stats-title {
            font-weight: 600;
            margin-bottom: 8px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 16px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 600;
            color: #24292e;
        }

        .stat-label {
            font-size: 12px;
            color: #586069;
        }

        .disabled-cell {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="month-labels" id="monthLabels"></div>
        <div class="graph">
            <div class="weekday-labels">
                <div class="weekday-label">Mon</div>
                <div class="weekday-label">Wed</div>
                <div class="weekday-label">Fri</div>
            </div>
            <div class="contribution-grid" id="contributionGrid"></div>
        </div>
        <div class="legend">
            <span class="legend-text">Learn how we count contributions</span>
            <span class="legend-text">Less</span>
            <div class="legend-cells">
                <div class="legend-cell level-0"></div>
                <div class="legend-cell level-1"></div>
                <div class="legend-cell level-2"></div>
                <div class="legend-cell level-3"></div>
                <div class="legend-cell level-4"></div>
            </div>
            <span class="legend-text">More</span>
        </div>
        <div class="stats">
            <div class="stats-title">Contribution Statistics</div>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-value" id="totalCount">0</div>
                    <div class="stat-label">Total Contributions</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="level1Count">0</div>
                    <div class="stat-label">Level 1 (1-3)</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="level2Count">0</div>
                    <div class="stat-label">Level 2 (4-6)</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="level3Count">0</div>
                    <div class="stat-label">Level 3 (7-9)</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="level4Count">0</div>
                    <div class="stat-label">Level 4 (10+)</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        
        function formatDate(date, contributionLevel) {
            const contributionsMap = {
                0: 0,
                1: Math.floor(Math.random() * 3) + 1,    // 1-3
                2: Math.floor(Math.random() * 3) + 4,    // 4-6
                3: Math.floor(Math.random() * 3) + 7,    // 7-9
                4: Math.floor(Math.random() * 3) + 10    // 10+
            };
            const contributions = contributionsMap[contributionLevel];
            return `${contributions} contributions on ${date.toLocaleDateString('en-US', {
                weekday: 'long',
                month: 'long',
                day: 'numeric',
                year: 'numeric'
            })}`;
        }

        function updateStats() {
            const grid = document.getElementById('contributionGrid');
            const cells = grid.getElementsByClassName('contribution-cell');
            let stats = {
                total: 0,
                level1: 0,
                level2: 0,
                level3: 0,
                level4: 0
            };

            for (let cell of cells) {
                if (!cell.classList.contains('disabled-cell')) {
                    const level = parseInt(cell.className.match(/level-(\d+)/)?.[1] || 0);
                    if (level > 0) {
                        stats.total++;
                        stats[`level${level}`]++;
                    }
                }
            }

            document.getElementById('totalCount').textContent = stats.total;
            document.getElementById('level1Count').textContent = stats.level1;
            document.getElementById('level2Count').textContent = stats.level2;
            document.getElementById('level3Count').textContent = stats.level3;
            document.getElementById('level4Count').textContent = stats.level4;
        }

        function createGraph() {
            const grid = document.getElementById('contributionGrid');
            const monthLabelsContainer = document.getElementById('monthLabels');
            grid.innerHTML = '';
            monthLabelsContainer.innerHTML = '';

            // 设置2024年的日期范围
            const currentYear = 2024;
            let startDate = new Date(currentYear, 0, 1);
            let endDate = new Date(currentYear, 11, 31);

            // 调整起始日期到上一个周日
            while (startDate.getDay() !== 0) {
                startDate.setDate(startDate.getDate() - 1);
            }

            // 添加月份标签
            months.forEach(month => {
                const monthLabel = document.createElement('div');
                monthLabel.className = 'month-label';
                monthLabel.textContent = month;
                monthLabelsContainer.appendChild(monthLabel);
            });

            // 创建一个二维数组来存储单元格元素
            const cellMatrix = Array(7).fill().map(() => Array(53).fill(null));

            // 首先创建所有单元格并存储在二维数组中
            for (let week = 0; week < 53; week++) {
                for (let day = 0; day < 7; day++) {
                    const cell = document.createElement('div');
                    const currentDate = new Date(startDate);
                    currentDate.setDate(startDate.getDate() + (week * 7) + day);
                    
                    const isWithinYear = currentDate.getFullYear() === currentYear;
                    
                    if (!isWithinYear) {
                        cell.className = 'contribution-cell disabled-cell level-0';
                    } else {
                        cell.className = 'contribution-cell level-0';
                        const tooltipText = formatDate(currentDate, 0);
                        cell.setAttribute('data-tooltip', tooltipText);
                        cell.setAttribute('data-date', currentDate.toISOString().split('T')[0]);
                        
                        cell.onclick = function() {
                            if (!this.classList.contains('disabled-cell')) {
                                cycleContributionLevel(this);
                            }
                        };
                    }
                    
                    cellMatrix[day][week] = cell;
                }
            }

            // 按列遍历并添加到网格中
            for (let day = 0; day < 7; day++) {
                for (let week = 0; week < 53; week++) {
                    grid.appendChild(cellMatrix[day][week]);
                }
            }
            
            updateStats();
        }

        function cycleContributionLevel(cell) {
            const currentLevel = parseInt(cell.className.match(/level-(\d+)/)?.[1] || 0);
            const nextLevel = (currentLevel + 1) % 5;
            cell.className = `contribution-cell level-${nextLevel}`;
            
            // 更新tooltip
            const date = new Date(cell.getAttribute('data-date'));
            cell.setAttribute('data-tooltip', formatDate(date, nextLevel));
            
            updateStats();
        }

        createGraph();
    </script>
</body>
</html>
